{"version":3,"file":"routes-manifest-plugin.js","sources":["../../../../src/start-router-plugin/generator-plugins/routes-manifest-plugin.ts"],"sourcesContent":["import { rootRouteId } from '@tanstack/router-core'\n\nimport type { GeneratorPlugin } from '@tanstack/router-generator'\n\n/**\n * this plugin builds the routes manifest and stores it on globalThis\n * so that it can be accessed later (e.g. from a vite plugin)\n */\nexport function routesManifestPlugin(): GeneratorPlugin {\n  return {\n    name: 'routes-manifest-plugin',\n    onRouteTreesChanged: ({ routeTrees, rootRouteNode }) => {\n      const routeTree = routeTrees.find((tree) => tree.exportName === 'Route')\n      if (!routeTree) {\n        throw new Error(\n          'No route tree found with export name \"Route\". Please ensure your routes are correctly defined.',\n        )\n      }\n      const routesManifest = {\n        [rootRouteId]: {\n          filePath: rootRouteNode.fullPath,\n          children: routeTree.acc.routeTree.map((d) => d.routePath),\n        },\n        ...Object.fromEntries(\n          routeTree.acc.routeNodes.map((d) => {\n            const filePathId = d.routePath\n\n            return [\n              filePathId,\n              {\n                filePath: d.fullPath,\n                parent: d.parent?.routePath ? d.parent.routePath : undefined,\n                children: d.children?.map((childRoute) => childRoute.routePath),\n              },\n            ]\n          }),\n        ),\n      }\n\n      globalThis.TSS_ROUTES_MANIFEST = { routes: routesManifest }\n    },\n  }\n}\n"],"names":[],"mappings":";AAQO,SAAS,uBAAwC;AAC/C,SAAA;AAAA,IACL,MAAM;AAAA,IACN,qBAAqB,CAAC,EAAE,YAAY,oBAAoB;AACtD,YAAM,YAAY,WAAW,KAAK,CAAC,SAAS,KAAK,eAAe,OAAO;AACvE,UAAI,CAAC,WAAW;AACd,cAAM,IAAI;AAAA,UACR;AAAA,QACF;AAAA,MAAA;AAEF,YAAM,iBAAiB;AAAA,QACrB,CAAC,WAAW,GAAG;AAAA,UACb,UAAU,cAAc;AAAA,UACxB,UAAU,UAAU,IAAI,UAAU,IAAI,CAAC,MAAM,EAAE,SAAS;AAAA,QAC1D;AAAA,QACA,GAAG,OAAO;AAAA,UACR,UAAU,IAAI,WAAW,IAAI,CAAC,MAAM;;AAClC,kBAAM,aAAa,EAAE;AAEd,mBAAA;AAAA,cACL;AAAA,cACA;AAAA,gBACE,UAAU,EAAE;AAAA,gBACZ,UAAQ,OAAE,WAAF,mBAAU,aAAY,EAAE,OAAO,YAAY;AAAA,gBACnD,WAAU,OAAE,aAAF,mBAAY,IAAI,CAAC,eAAe,WAAW;AAAA,cAAS;AAAA,YAElE;AAAA,UACD,CAAA;AAAA,QAAA;AAAA,MAEL;AAEW,iBAAA,sBAAsB,EAAE,QAAQ,eAAe;AAAA,IAAA;AAAA,EAE9D;AACF;"}